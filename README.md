# machinelearning-homework-5-sequence-to-sequence-solved
**TO GET THIS SOLUTION VISIT:** [MachineLearning Homework 5-Sequence to Sequence Solved](https://www.ankitcodinghub.com/product/machinelearning-homework-5-sequence-to-sequence-solved/)


---

📩 **If you need this solution or have special requests:** **Email:** ankitcoding@gmail.com  
📱 **WhatsApp:** +1 419 877 7882  
📄 **Get a quote instantly using this form:** [Ask Homework Questions](https://www.ankitcodinghub.com/services/ask-homework-questions/)

*We deliver fast, professional, and affordable academic help.*

---

<h2>Description</h2>



<div class="kk-star-ratings kksr-auto kksr-align-center kksr-valign-top" data-payload="{&quot;align&quot;:&quot;center&quot;,&quot;id&quot;:&quot;92718&quot;,&quot;slug&quot;:&quot;default&quot;,&quot;valign&quot;:&quot;top&quot;,&quot;ignore&quot;:&quot;&quot;,&quot;reference&quot;:&quot;auto&quot;,&quot;class&quot;:&quot;&quot;,&quot;count&quot;:&quot;0&quot;,&quot;legendonly&quot;:&quot;&quot;,&quot;readonly&quot;:&quot;&quot;,&quot;score&quot;:&quot;0&quot;,&quot;starsonly&quot;:&quot;&quot;,&quot;best&quot;:&quot;5&quot;,&quot;gap&quot;:&quot;4&quot;,&quot;greet&quot;:&quot;Rate this product&quot;,&quot;legend&quot;:&quot;0\/5 - (0 votes)&quot;,&quot;size&quot;:&quot;24&quot;,&quot;title&quot;:&quot;MachineLearning Homework 5-Sequence to Sequence Solved&quot;,&quot;width&quot;:&quot;0&quot;,&quot;_legend&quot;:&quot;{score}\/{best} - ({count} {votes})&quot;,&quot;font_factor&quot;:&quot;1.25&quot;}">

<div class="kksr-stars">

<div class="kksr-stars-inactive">
            <div class="kksr-star" data-star="1" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="2" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="3" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="4" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" data-star="5" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>

<div class="kksr-stars-active" style="width: 0px;">
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
            <div class="kksr-star" style="padding-right: 4px">


<div class="kksr-icon" style="width: 24px; height: 24px;"></div>
        </div>
    </div>
</div>


<div class="kksr-legend" style="font-size: 19.2px;">
            <span class="kksr-muted">Rate this product</span>
    </div>
    </div>
<div class="page" title="Page 1">
<div class="section">
<div class="layoutArea">
<div class="column"></div>
</div>
</div>
</div>
<div class="page" title="Page 2">
<div class="section">
<div class="layoutArea">
<div class="column">
&nbsp;

</div>
</div>
</div>
</div>
<div class="page" title="Page 3">
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Introduction to sequence to sequence

</div>
</div>
</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="page" title="Page 4">
<div class="section">
<div class="layoutArea">
<div class="column">
Sequence to sequence

Generate a sequence from another sequence

Translation ASR TTS

text to text speech to text text to speech

</div>
</div>
<div class="layoutArea">
<div class="column">
and more…

</div>
</div>
</div>
</div>
<div class="page" title="Page 5">
<div class="section">
<div class="layoutArea">
<div class="column">
Sequence to sequence

Often composed of encoder and decoder

<ul>
<li>● &nbsp;Encoder: encodes input sequence into a vector or sequence of vectors</li>
<li>● &nbsp;Decoder: decodes a sequence one token at a time, based on 1) encoder
output and 2) previous decoded tokens
</li>
</ul>
</div>
</div>
<div class="layoutArea">
<div class="column">
1)

</div>
</div>
<div class="layoutArea">
<div class="column">
2)

</div>
</div>
</div>
</div>
<div class="page" title="Page 6">
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
HW5: Machine Translation

</div>
</div>
</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="page" title="Page 7">
<div class="section">
<div class="layoutArea">
<div class="column">
Neural Machine Translation

We will translate from english to traditional chinese ● Cats are so cute. -&gt; 貓咪真可愛。

A sentence is usually translated into another language with different length. Naturally, the seq2seq framework is applied on this task.

</div>
</div>
</div>
</div>
<div class="page" title="Page 8">
<div class="section">
<div class="layoutArea">
<div class="column">
Training datasets

<ul>
<li>● &nbsp;Paired data
<ul>
<li>○ &nbsp;TED2020: TED talks with transcripts translated by a global community of volunteers to
more than 100 language
</li>
<li>○ &nbsp;We will use (en, zh-tw) aligned pairs</li>
</ul>
</li>
<li>● &nbsp;Monolingual data</li>
</ul>
○ More TED talks in traditional Chinese

</div>
</div>
</div>
</div>
<div class="page" title="Page 9">
<div class="section">
<div class="layoutArea">
<div class="column">
Evaluation

BLEU

<ul>
<li>● &nbsp;Modified1 n-gram precision (n=1~4)</li>
<li>● &nbsp;Brevity penalty: penalizes short hypotheses</li>
</ul>
</div>
<div class="column">
source: Cats are so cute. target:貓咪真可愛。 output: 貓好可愛。

</div>
</div>
<div class="layoutArea">
<div class="column">
○ c is the hypothesis length, r is the reference length

● The BLEU score is the geometric mean of n-gram precision, multiplied by

brevity penalty

</div>
</div>
<div class="layoutArea">
<div class="column">
1the precision is clamped to # occurence in reference.

</div>
</div>
</div>
</div>
<div class="page" title="Page 10">
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Workflow

</div>
</div>
</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="page" title="Page 11">
<div class="section">
<div class="layoutArea">
<div class="column">
Workflow

1. Preprocessing

</div>
<div class="column">
2. Training

</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
raw training data data

</div>
</div>
</div>
<div class="section">
<div class="layoutArea">
<div class="column">
model architecture

training…

</div>
</div>
<div class="layoutArea">
<div class="column">
test data

</div>
</div>
<div class="layoutArea">
<div class="column">
trained model

</div>
</div>
<div class="layoutArea">
<div class="column">
performance

</div>
</div>
</div>
<div class="layoutArea">
<div class="column">
3. Testing

</div>
</div>
</div>
</div>
<div class="page" title="Page 12">
<div class="section">
<div class="layoutArea">
<div class="column">
Workflow

1. Preprocessing

<ol>
<li>download raw data</li>
<li>clean and normalize</li>
<li>remove bad data (too long/short)</li>
<li>tokenization</li>
</ol>
2. Training

<ol>
<li>initialize a model</li>
<li>train it with training data</li>
</ol>
3. Testing

<ol>
<li>generate translation of test data</li>
<li>evaluate the performance</li>
</ol>
</div>
</div>
</div>
</div>
<div class="page" title="Page 13">
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Training tips

</div>
</div>
</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="page" title="Page 14">
<div class="section">
<div class="layoutArea">
<div class="column">
Training tips

<ul>
<li>● &nbsp;Tokenize data with sub-word units</li>
<li>● &nbsp;Label smoothing regularization</li>
<li>● &nbsp;Learning rate scheduling ● Back-translation</li>
</ul>
</div>
</div>
</div>
</div>
<div class="page" title="Page 15">
<div class="section">
<div class="layoutArea">
<div class="column">
Training tips

● Tokenize data with sub-word units

<ul>
<li>○ &nbsp;For one, we can reduce the vocabulary size (common prefix/suffix)</li>
<li>○ &nbsp;For another, alleviate the open vocabulary problem ○ example
<ul>
<li>▁new ▁ways ▁of ▁making ▁electric ▁trans port ation ▁.</li>
<li>new ways of making electric transportation.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="page" title="Page 16">
<div class="section">
<div class="layoutArea">
<div class="column">
Training tips

● Label smoothing regularization

<ul>
<li>○ &nbsp;When calculating loss, reserve some probability for incorrect labels</li>
<li>○ &nbsp;Avoids overfitting</li>
</ul>
</div>
</div>
</div>
</div>
<div class="page" title="Page 17">
<div class="section">
<div class="layoutArea">
<div class="column">
Training tips

● Learning rate scheduling

<ul>
<li>○ &nbsp;Linearly increase lr and then decay by inverse square root of steps</li>
<li>○ &nbsp;Stablilize training of transformers in early stages</li>
</ul>
</div>
</div>
</div>
</div>
<div class="page" title="Page 18">
<div class="section">
<div class="layoutArea">
<div class="column">
Back-translation (BT)

Leverage monolingual data by creating synthetic translation data

<ol>
<li>Train a translation system in the opposite direction</li>
<li>Collect monolingual data in target side and apply machine translation</li>
<li>Use translated and original monolingual data as additional parallel data to</li>
</ol>
</div>
</div>
<div class="layoutArea">
<div class="column">
train stronger translation systems

translated monoligual data

</div>
<div class="column">
back-translation

</div>
</div>
<div class="layoutArea">
<div class="column">
monolingual data

</div>
</div>
<div class="layoutArea">
<div class="column">
source language

</div>
<div class="column">
target language

</div>
</div>
<div class="layoutArea">
<div class="column">
original data

</div>
<div class="column">
original data

</div>
</div>
</div>
</div>
<div class="page" title="Page 19">
<div class="section">
<div class="layoutArea">
<div class="column">
Back-translation

Some points to note about back-translation

<ol>
<li>Monolingual data should be in the same domain as the parallel corpus</li>
<li>The performance of the backward model is critical</li>
<li>You should increase model capacity (both forward and backward), since
the data amount is increased.
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="page" title="Page 20">
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Requirements

</div>
</div>
</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="page" title="Page 21">
<div class="section">
<div class="layoutArea">
<div class="column">
Requirements

You are encouraged to follow these tips to improve your performance in order to pass the 3 baselines.

<ol>
<li>Train a simple RNN seq2seq to acheive translation</li>
<li>Switch to transformer to boost performance</li>
<li>Apply back-translation to furthur boost performance</li>
</ol>
</div>
</div>
</div>
</div>
<div class="page" title="Page 22">
<div class="section">
<div class="layoutArea">
<div class="column">
Baseline Guide

Train a simple RNN seq2seq to acheive translation

● Running the sample code should pass the baseline!

</div>
</div>
</div>
</div>
<div class="page" title="Page 23">
<div class="section">
<div class="layoutArea">
<div class="column">
Baseline Guide

Switch to transformer to boost performance

<ol>
<li>Change the encoder/decoder architecture to transformer based,
according to the hints in sample code

<ul>
<li>○ &nbsp;RNNEncoder -&gt; TransformerEncoder</li>
<li>○ &nbsp;RNNDecoder -&gt; TransformerDecoder</li>
</ul>
</li>
<li>Change architecture configurations</li>
</ol>
○ encoder_ffn_embed_dim -&gt; 1024

</div>
</div>
<div class="layoutArea">
<div class="column">
○ encoder_layers/decoder_layers -&gt; 4

</div>
</div>
<div class="layoutArea">
<div class="column">
○ #add_transformer_args(arch_args) -&gt; add_transformer_args(arch_args)

</div>
</div>
</div>
</div>
<div class="page" title="Page 24">
<div class="section">
<div class="layoutArea">
<div class="column">
Baseline Guide

Apply back-translation to furthur boost performance

<ol>
<li>Train a backward model by switching languages
<ul>
<li>○ &nbsp;source_lang = “zh”</li>
<li>○ &nbsp;target_lang = “en”</li>
</ul>
</li>
<li>Remember to change architecture to transformer-base</li>
<li>Translate monolingual data with backward model to obtain synthetic data
<ul>
<li>○ &nbsp;complete TODOs in the sample code.</li>
<li>○ &nbsp;all the TODOs can be completed by using commands from earlier cells.</li>
</ul>
</li>
<li>Train a stronger forward model with the new data</li>
</ol>
○ if done correctly, ~30 epochs on new data should pass the baseline.

</div>
</div>
</div>
</div>
<div class="page" title="Page 25">
<div class="section">
<div class="layoutArea">
<div class="column">
Expected Run Time

● on colab with Tesla T4

</div>
</div>
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Baseline

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
Details

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
Total time

</div>
</div>
</td>
</tr>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Simple

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
2m15s x 30 epochs

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
1hr 8m

</div>
</div>
</td>
</tr>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Medium

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
4m x 30 epochs

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
2hr

</div>
</div>
</td>
</tr>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Strong

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
8m x 30 epochs (backward) + 1hr (back-translation)

+ 15m x 30 epochs (forward)

</div>
</div>
</td>
<td>
<div class="layoutArea">
<div class="column">
12hr 30m

</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="layoutArea">
<div class="column">
● TA’s training curve https://wandb.ai/george0828zhang/hw5.seq2seq.new

</div>
</div>
</div>
</div>
<div class="page" title="Page 26">
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
Submission &amp; Grading

</div>
</div>
</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="page" title="Page 27">
<div class="section">
<div class="layoutArea">
<div class="column">
Prediction Submission

<ul>
<li>● &nbsp;Submit to JudgeBoi</li>
<li>● &nbsp;One example per line, in the original order</li>
<li>● &nbsp;Punctuation will be normalized by JudgeBoi with this script</li>
<li>● &nbsp;Deadline: 4/30 (Fri.) 23:59</li>
</ul>
</div>
</div>
</div>
</div>
<div class="page" title="Page 28">
<div class="layoutArea">
<div class="column">
Code Submission

● NTU COOL (4pts)

<ul>
<li>○ &nbsp;Deadline: 5/2 (Sun.) 23:59</li>
<li>○ &nbsp;Compress your code and report into &lt;student ID&gt;_hwX.zip
* e.g. b06901020_hw5.zip

* X is the homework number
</li>
<li>○ &nbsp;We can only see your last submission.</li>
<li>○ &nbsp;Do not submit your model or dataset.</li>
<li>○ &nbsp;If your code is not reasonable, your semester grade x 0.9.</li>
</ul>
</div>
</div>
</div>
<div class="page" title="Page 29">
<div class="layoutArea">
<div class="column">
Code Submission

● Your .zip file should include only

<ul>
<li>○ &nbsp;Code: either .py or .ipynb</li>
<li>○ &nbsp;Report: .pdf (only for those who got 10 points)</li>
</ul>
</div>
</div>
<div class="layoutArea">
<div class="column">
● Example:

</div>
</div>
<div class="layoutArea">
<div class="column">
hw5.ipynb

</div>
</div>
</div>
<div class="page" title="Page 30">
<div class="layoutArea">
<div class="column">
Regulation

<ul>
<li>● &nbsp;You should NOT plagiarize, if you use any other resource, you should cite it in the reference. (*)</li>
<li>● &nbsp;You should NOT modify your prediction files manually.</li>
<li>● &nbsp;Do NOT share codes or prediction files with any living creatures.</li>
<li>● &nbsp;Do NOT use any approaches to submit your results more than 5 times a
day.
</li>
</ul>
</div>
</div>
</div>
<div class="page" title="Page 32">
<div class="layoutArea">
<div class="column">
<ul>
<li>● &nbsp;Report template</li>
</ul>
</div>
</div>
</div>
<div class="page" title="Page 33">
<table>
<tbody>
<tr>
<td>
<div class="layoutArea">
<div class="column">
JudgeBoi Guide

</div>
</div>
</td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="page" title="Page 34">
<div class="section">
<div class="layoutArea">
<div class="column">
Previously… Github Account Survey

We have kindly requested everyone to report your github username and ID. IMPORTANT: You must take this survey in order to submit to JudgeBoi server.

</div>
</div>
</div>
</div>
<div class="page" title="Page 35">
<div class="section">
<div class="layoutArea">
<div class="column">
Step 1: Register for Submission

Go to JudgeBoi to login.

</div>
</div>
</div>
</div>
<div class="page" title="Page 36">
<div class="section">
<div class="layoutArea">
<div class="column">
Step 2: Sign-in with Github

You need to sign in with the account you reported to us. Or you won’t be able to upload your submissions.

</div>
</div>
<div class="layoutArea">
<div class="column">
fill in username &gt; fill in password &gt;

</div>
</div>
</div>
</div>
<div class="page" title="Page 37">
<div class="section">
<div class="layoutArea">
<div class="column">
Step 3: Submit your Results

You can now submit results to the server and view the leaderboard.

1) click here

</div>
</div>
<div class="layoutArea">
<div class="column">
3) view leaderboard here 2) Submit result here

</div>
</div>
</div>
</div>
<div class="page" title="Page 38">
<div class="section">
<div class="layoutArea">
<div class="column">
Step 4: Select your submissions

<ul>
<li>● &nbsp;You can select up to 2 submissions.</li>
<li>● &nbsp;If none of your submissions is chosen, we will use your first submission to
calculate your private score.
</li>
<li>● &nbsp;If your selection is successful, you will see a message box as follows:</li>
</ul>
</div>
</div>
</div>
</div>
<div class="page" title="Page 39">
<div class="section">
<div class="layoutArea">
<div class="column">
More about JudgeBoi

<ul>
<li>● &nbsp;5 submission quota per day, reset at midnight. Users not in whitelist will have no quota.</li>
<li>● &nbsp;Only *.txt file is allowed, filesize should be smaller than 700kB.</li>
<li>● &nbsp;The countdown timer on the homepage is for reference only.</li>
<li>● &nbsp;We do limit the number of connections and request rate for each ip. If you
cannot access the website temporarily, please wait patiently.
</li>
<li>● &nbsp;Please do not attempt to attack JudgeBoi, thank you.</li>
<li>● &nbsp;Every Wednesday and Saturday from 0:00 to 3:00 is our system
maintenance time. If the website cannot be used during this time, please wait patiently for the completion of the maintenance.
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="page" title="Page 40">
<div class="section">
<div class="layoutArea">
<div class="column">
Links

Sample code Colab Colab(chinese version) Parallel data TED2020

Testing data Testdata

Monolingual TED_ZH

</div>
</div>
</div>
</div>
<div class="page" title="Page 41">
<div class="layoutArea">
<div class="column"></div>
</div>
</div>
<div class="page" title="Page 42">
<div class="section">
<div class="layoutArea">
<div class="column">
&nbsp;

Q: My backward (zh-en) model is significantly weaker than forward (en-zh) model, what’s going on?

A: BLEU scores aren’t comparable across languages. However, your backward model should be as strong as possible for BT to work properly.

Q: Larger models or synthetic data requires long training time, but colab has limited usage?

A: The sample code saves model checkpoints each epoch, see next page.

</div>
</div>
</div>
</div>
<div class="page" title="Page 43">
<div class="section">
<div class="layoutArea">
<div class="column">
Save checkpoints and data to drive

<ol>
<li>Mount your drive by clicking</li>
<li>Save your preprocessed DATA to your drive
<pre>      !mkdir -p /content/drive/MyDrive/ML2021-hw5/
      !cp -r ./DATA /content/drive/MyDrive/ML2021-hw5/
</pre>
</li>
<li>Change checkpoint directory (under config) to your drive
<pre>      savedir = "/content/drive/MyDrive/ML2021-hw5/checkpoints/transformer",
</pre>
</li>
</ol>
Next time, load preprocessed data quicky with

<pre> !ln -s /content/drive/MyDrive/ML2021-hw5/DATA/ ./DATA  # symbolic link
 # !cp -r /content/drive/MyDrive/ML2021-hw5/DATA/ ./    # or you can use full copy
</pre>
Change resume (under config) to following to resume from checkpoint.

<pre> resume="checkpoint_last.pt", # if resume from checkpoint name (under config.savedir)
</pre>
</div>
</div>
</div>
</div>
